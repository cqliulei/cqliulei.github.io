






<!doctype html>
<html lang="zh-CN">
<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="author" content="liulei">
  
  
  
  
    <meta name="description" content="写在前面刚入门前端的时候写过很多的微信H5页面，时隔多年感觉应该是手到擒来，不曾想竟很是费了一些功夫。现在把本次开发过程中遇到的问题以及我是如何解决的，做个记录。防止自己以后再去解决解决过的问题。github：https://github.com/qq9694526/vue-wxh5
一、微信网页授权网页授权流程分为四步，这里只说前端需要做的，其中的第一步：跳转授权页面获取code。这里分享...">
  
  <title>微信开发遇到的坑 [ Lynn Lau ]</title>
  
    <link rel="alternate" href="/atom.xml" title="Lynn Lau">
  
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
    
      <link rel="stylesheet" href="/css/random.css">
<link rel="stylesheet" href="/css/vegas.min.css">
<link rel="stylesheet" href="/css/highlight-railscasts.css">
<link rel="stylesheet" href="/css/jquery.fancybox.css">
<link rel="stylesheet" href="/css/iconfont/iconfont.css">
<link rel="stylesheet" href="/css/jquery.fancybox-thumbs.css">
<link rel="stylesheet" href="/css/plyr.css">
<link rel="stylesheet" href="/css/layout.css">
    
     
</head>

<body>
<div class="side-navigate hide-area">
  
  
    <div class="item next">
      <a href="/2011/05/06/zh-cn/2011/05/06/ywm/">
        <div class="item-icon"></div>
      </a>
      <div class="item-title">
        夜无眠
      </div>
    </div>
  
</div>
<div id="outer-container" class="hide-area">
<div id="container">
  <div id="menu-outer" class="slide-down">
    <div id="menu-inner">
      <div id="brand">
        
        <a onClick="openUserCard()">
          <img id="avatar" src="http://img.cqliulei.com/assets/img/logo_avatar.jpg"/>
          <div id="homelink">Lynn Lau</div>
        </a>
      </div>
      <div id="menu-list">
        <ul>
        
        
          
            <li>
          
            <a href="/index.html">主页</a>
            
          </li>
        
          
            <li>
          
            <a href="/archives">文章</a>
            
          </li>
        
          
            <li>
          
            <a href="/works">作品</a>
            
          </li>
        
          
            <li>
          
            <a href="/about">关于</a>
            
          </li>
        
          
            <li>
          
            <a href="https://github.com/cqliulei">Github</a>
            
          </li>
        
        </ul>
      </div>
      <div id="show-menu">
        <button>Menu</button>
      </div>
    </div>
  </div>

  <div id="content-outer">
    <div id="content-inner">
      
      
  <article id="post" class="post-show-content">
    <h1>微信开发遇到的坑</h1>
    <p class="page-title-sub">
      <span id = "post-title-date">撰写于 2018-12-25</span>
      
        <span id = "post-title-updated">修改于 2018-12-27</span>
      
      
      <span id = "post-title-categories">分类
      
      
        
        
        <a href="/categories/前端开发/">前端开发</a>
      
      </span>
      
      
      <span id = "post-title-tags">
      标签
      
      
        
        
        <a href="/tags/css/">css</a>
      
      </span>
      
    </p>
    
    <h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>刚入门前端的时候写过很多的微信H5页面，时隔多年感觉应该是手到擒来，不曾想竟很是费了一些功夫。现在把本次开发过程中遇到的问题以及我是如何解决的，做个记录。防止自己以后再去解决解决过的问题。<br><strong>github</strong>：<a href="https://github.com/qq9694526/vue-wxh5" target="_blank" rel="noopener">https://github.com/qq9694526/vue-wxh5</a></p>
<h2 id="一、微信网页授权"><a href="#一、微信网页授权" class="headerlink" title="一、微信网页授权"></a>一、微信网页授权</h2><p>网页授权流程分为四步，这里只说前端需要做的，其中的第一步：跳转授权页面获取code。<br>这里分享下我的授权逻辑（下图），它有两个优点：   </p>
<ol>
<li>授权跳转在dom渲染之前，体验会好一些；   </li>
<li>本地存储了openId，前后端均不用频繁的与微信服务器交互。  </li>
</ol>
<h2 id="二、微信jssdk授权"><a href="#二、微信jssdk授权" class="headerlink" title="二、微信jssdk授权"></a>二、微信jssdk授权</h2><p>如果你页面中有用到分享、上传图片、微信支付等功能，那么需要先进行js-sdk授权。我这边封装成了2个方法：initConfig和setShare，方便在路由/页面切换的时候重复调用。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.js</span></span><br><span class="line"><span class="keyword">import</span> wxsdk <span class="keyword">from</span> <span class="string">'./config/wxsdk.js'</span> <span class="comment">//该模块提供initConfig和setShare方法，具体代码太长见github</span></span><br><span class="line">Vue.prototype.wxsdk = wxsdk;<span class="comment">//挂载到全局</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line"> created() &#123;</span><br><span class="line">   <span class="keyword">this</span>.wxsdk.initConfig(location.href.split(<span class="string">"#"</span>)[<span class="number">0</span>], () =&gt; &#123;</span><br><span class="line">     <span class="keyword">this</span>.wxsdk.setShare(<span class="keyword">this</span>.user.openId);</span><br><span class="line">    &#125;);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="三、webpack-dev-server解决跨域"><a href="#三、webpack-dev-server解决跨域" class="headerlink" title="三、webpack-dev-server解决跨域"></a>三、webpack-dev-server解决跨域</h2><p>讲真的所有跨域解决方案都必须有服务端的参与，诚然这个问题是浏览器抛出的，但让前端去解决真的很冤。下面两个配置让你永远告别跨域烦恼。本地开发用webpack-dev-server，测试生产环境用nginx。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口根路径http://47.105.59.***:9090/zt-wx</span></span><br><span class="line"><span class="comment">//以vue-cli搭建的项目config举例 config/index.js</span></span><br><span class="line">  dev: &#123;</span><br><span class="line">    proxyTable: &#123;</span><br><span class="line">      <span class="string">'/zt-wx'</span>: &#123;</span><br><span class="line">        target: <span class="string">'http://47.105.59.***:9090'</span>,  <span class="comment">//目标接口域名</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>  <span class="comment">//是否跨域</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//实际发起请求时的url</span></span><br><span class="line"><span class="keyword">this</span>.http.get(<span class="string">`/zt-wx/api/wx/info`</span>).then(); <span class="comment">//http是我自己对axios的再封装  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//nginx代理配置</span></span><br><span class="line">server &#123;</span><br><span class="line">    location /zt-wx &#123;</span><br><span class="line">		proxy_pass http:<span class="comment">//47.105.59.***:9090;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="四、iso初次加载白屏、跳转白屏"><a href="#四、iso初次加载白屏、跳转白屏" class="headerlink" title="四、iso初次加载白屏、跳转白屏"></a>四、iso初次加载白屏、跳转白屏</h2><p><strong>问题现象</strong>： ios页面初次加载白屏，刷新后正常，但切换到其他页面再后退，又会白屏。<br><strong>问题原因</strong>：在ios机器上使用webview开发Vue项目时候，go history(-1)，无法将body的高度拉掉，使得内容被遮住了。<br><strong>解决办法</strong>：html，body都是100%，#app撑起了父元素的告诉，但是浏览器默认的滚动scroll并不是#app，而是body,某些因素，造成返回history 后，无法复原（ios 的锅），为此，我们将#app进行了绝对定位，并让它重新成为 scroll 的对象，从而解决问题。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#app</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: scroll;</span><br><span class="line">  <span class="attribute">-webkit-overflow-scrolling</span>: touch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>参考资料：<a href="https://blog.csdn.net/guxuehua/article/details/79026655" target="_blank" rel="noopener">https://blog.csdn.net/guxuehua/article/details/79026655</a></p>
<h2 id="五、ios路由-跳转页面后分享失效"><a href="#五、ios路由-跳转页面后分享失效" class="headerlink" title="五、ios路由/跳转页面后分享失效"></a>五、ios路由/跳转页面后分享失效</h2><p><strong>问题现象</strong>：ios微信路由到另一个页面选择图片OK，但分享失效，刷新这个页面分享就正常了。<br>已累计尝试解决超过8小时，至今未果。<br>参考资料：<a href="https://www.zhihu.com/question/59388458/answer/340351305" target="_blank" rel="noopener">https://www.zhihu.com/question/59388458/answer/340351305</a></p>
<h2 id="六、上传图片报错：处理异常"><a href="#六、上传图片报错：处理异常" class="headerlink" title="六、上传图片报错：处理异常"></a>六、上传图片报错：处理异常</h2><p>这个报错甚是诡异，因为前端和后端代码均没有“处理异常”这4个字。本来想甩锅给微信不管了的，但随后在做限制上传图片大小功能的时候阴差阳错的给解决了。<br><strong>问题原因</strong>：后端tomcat服务默认设置表单提交数据大小上限为2M，大于2M就会报错。<br><strong>解决办法</strong>：后端大神把server.xml中maxPostSize的值改为-1后解决。<br>参考资料：<a href="https://blog.csdn.net/w18756901575/article/details/79374621" target="_blank" rel="noopener">https://blog.csdn.net/w18756901575/article/details/79374621</a></p>
<h2 id="七、正确导出图片格式"><a href="#七、正确导出图片格式" class="headerlink" title="七、正确导出图片格式"></a>七、正确导出图片格式</h2><p>这个项目首页基本是由图片堆砌成的，一开始切出来的图(默认.png)压缩后在400k-1.3M之间。一开始还以为PSD素材有问题。直到项目最后才闪回，想起图片格式的知识点，改导出成.jpg格式后压缩出来的图片基本控制在100K以内了。具体的.png.jpg这些图片格式的知识有兴趣的自己查。</p>
<h2 id="八、vuex使用之同步用户信息"><a href="#八、vuex使用之同步用户信息" class="headerlink" title="八、vuex使用之同步用户信息"></a>八、vuex使用之同步用户信息</h2><p>讲道理小项目是不应该用vuex的，但是用着确实爽，即简单又省心省力。由于我总是忘记它的方法名，所以在这里贴下代码，方便以后随时cv。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//config/store.js</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        user: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mutations：&#123;</span><br><span class="line">        updateUser(state, data)&#123;</span><br><span class="line">            state.user = data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//在组件中使用</span></span><br><span class="line">computed: &#123;</span><br><span class="line">    user() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.$store.state.user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在需要的时候更新数据</span></span><br><span class="line"><span class="keyword">this</span>.$store.commit(<span class="string">"updateUser"</span>, user);</span><br></pre></td></tr></table></figure></p>
<h2 id="九、使用html2canvas生成的海报不显示图片"><a href="#九、使用html2canvas生成的海报不显示图片" class="headerlink" title="九、使用html2canvas生成的海报不显示图片"></a>九、使用html2canvas生成的海报不显示图片</h2><p><strong>问题原因</strong>：引入的图片资源路径跨域造成的。<br><strong>解决办法</strong>：我先是按照官方给的那个php的方案弄的，未能解决。最后舔着脸让后端大佬把图片资源目录挪到我web服务目录下给解决的。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//安装</span></span><br><span class="line">npm install --save html2canvas</span><br><span class="line"><span class="comment">//引入</span></span><br><span class="line"><span class="keyword">import</span> html2canvas <span class="keyword">from</span> <span class="string">"html2canvas"</span>;</span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line"><span class="keyword">const</span> myPosterWrap = <span class="built_in">document</span>.getElementById(<span class="string">"posterWrap"</span>);</span><br><span class="line">html2canvas(myPosterWrap).then(<span class="function"><span class="params">canvas</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.posterSrc = canvas.toDataURL(<span class="string">"image/png"</span>);</span><br><span class="line">    <span class="keyword">this</span>.uploadPosterImg(<span class="keyword">this</span>.posterSrc);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2 id="十、css黑科技之放置指定比例的图片"><a href="#十、css黑科技之放置指定比例的图片" class="headerlink" title="十、css黑科技之放置指定比例的图片"></a>十、css黑科技之放置指定比例的图片</h2><p>就是把不定宽图片按指定比例显示，直接上码（1：1.25）。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//html</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"poster-img-wrap"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"poster-img-place"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"poster-img"</span> <span class="attr">:src</span>=<span class="string">"user.picAddress"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//less</span><br><span class="line"><span class="selector-class">.poster-img-wrap</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">28%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">80%</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    .poster-img-place &#123;</span><br><span class="line">        <span class="selector-tag">width</span>: 100%;</span><br><span class="line">        <span class="selector-tag">padding-top</span>: 125%;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.poster-img</span> &#123;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="十一、ios页面加载不全不能滚动"><a href="#十一、ios页面加载不全不能滚动" class="headerlink" title="十一、ios页面加载不全不能滚动"></a>十一、ios页面加载不全不能滚动</h2><p><strong>问题描述</strong> ：ios从首页进入，跳转其他页面再后退到首页，首页只显示一屏内容且无法滚动。<br><strong>问题原因</strong>：在于ios浏览器内核的别致渲染逻辑：它会预先找到相应的overflow: scroll元素，如果子元素高度高于父元素，则建立原生的scrollView实现滚动。问题就出现在这个“预先”上，它预先获取的高度并不是子元素渲染后的真实高度。<br><strong>解决办法</strong>：给设置了滚动的#app元素下的子元素p-index设置min-height: calc(100% + 1px);<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#app</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: scroll;</span><br><span class="line">  <span class="attribute">-webkit-overflow-scrolling</span>: touch;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.p-index</span>&#123;</span><br><span class="line">   <span class="attribute">min-height</span>: <span class="built_in">calc</span>(100% + 1px);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>其实能解决全靠这篇博文，这里就不赘述了。<a href="https://blog.csdn.net/nongweiyilady/article/details/83039868" target="_blank" rel="noopener">https://blog.csdn.net/nongweiyilady/article/details/83039868</a><br>神奇的是，我能看到这篇文章全来赖于地铁上无聊打开了很久没打开的CSDNapp，切到前端分类，“不滚动”三个字立马映入眼帘，点进去的第一眼 ，就感觉是对的人了。迷茫的时候就看书，古人诚不我欺！</p>
<h2 id="一些忠告"><a href="#一些忠告" class="headerlink" title="一些忠告"></a>一些忠告</h2><blockquote>
<ul>
<li>能小程序就别网页开发；</li>
<li>不意淫不揣摩待定的需求；</li>
<li>坚持看图作业的优良传统；</li>
<li>迷茫的时候看书，焦虑的时候学习；</li>
</ul>
</blockquote>

  </article>
  <div class="random-toc-area">
  <button class="btn-hide-toc btn-hide-toc-show" style="display: none" onclick="TOCToggle()">显示目录</button>
  <button class="btn-hide-toc btn-hide-toc-hide" onclick="TOCToggle()">隐藏目录</button>
  <div class="random-toc">
    <h2>目录</h2>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#写在前面"><span class="toc-text">写在前面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一、微信网页授权"><span class="toc-text">一、微信网页授权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、微信jssdk授权"><span class="toc-text">二、微信jssdk授权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、webpack-dev-server解决跨域"><span class="toc-text">三、webpack-dev-server解决跨域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、iso初次加载白屏、跳转白屏"><span class="toc-text">四、iso初次加载白屏、跳转白屏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、ios路由-跳转页面后分享失效"><span class="toc-text">五、ios路由/跳转页面后分享失效</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、上传图片报错：处理异常"><span class="toc-text">六、上传图片报错：处理异常</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七、正确导出图片格式"><span class="toc-text">七、正确导出图片格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#八、vuex使用之同步用户信息"><span class="toc-text">八、vuex使用之同步用户信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#九、使用html2canvas生成的海报不显示图片"><span class="toc-text">九、使用html2canvas生成的海报不显示图片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#十、css黑科技之放置指定比例的图片"><span class="toc-text">十、css黑科技之放置指定比例的图片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#十一、ios页面加载不全不能滚动"><span class="toc-text">十一、ios页面加载不全不能滚动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一些忠告"><span class="toc-text">一些忠告</span></a></li></ol>
  </div>
</div>

  
<nav id="pagination">
  

  

  
    <a href="/2011/05/06/zh-cn/2011/05/06/ywm/" class="next">下一篇 夜无眠 &rarr;</a>
  
</nav>

  <!-- JiaThis Button BEGIN -->

<!-- JiaThis Button END -->


      
      
      
    </div>
  </div>

  <!-- 评论-->
  


  <div id="bottom-outer">
    <div id="bottom-inner">
      Site by liulei using
      <a href="http://hexo.io">Hexo</a>
      <br>
      
    </div>
  </div>
 
</div>
</div>





<div id="user-card">
  <div class="center-field">
    <img class="avatar" src="http://img.cqliulei.com/assets/img/logo_avatar.jpg">
    <p id="description">为梦想，不休不止</p>
    <ul class="social-icon">
  
  
    <li>
      <a href="https://github.com/cqliulei">
        
          <i class="icon iconfont github">&#xe606;</i>
        
      </a>
    </li>
  
    <li>
      <a href="http://weibo.com/1632162353">
        
          <i class="icon iconfont weibo">&#xe602;</i>
        
      </a>
    </li>
  
</ul>
  </div>
</div>


<div id="btn-view">Hide</div>

<script>
// is trigger analytics / tongji script
var isIgnoreHost = false;

if(window && window.location && window.location.host) {
  isIgnoreHost = ["localhost","127.0.0.1"].some(function(address){
    return 0 === window.location.host.indexOf(address);
  });
}

var isTriggerAnalytics = !( true && isIgnoreHost );

</script>

  <script>
if(isTriggerAnalytics) {
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?076c9e7a9827d49ee5fbd569590ecf65";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
}
</script>


  <script>
if(isTriggerAnalytics) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84926965-1', 'auto');
  ga('send', 'pageview');
}

</script>

<!-- <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84926965-1', 'auto');
  ga('send', 'pageview');

</script> -->



  
  
    <script src="/js/jquery-2.2.3.min.js"></script>
  
    <script src="/js/vegas.min.js"></script>
  
    <script src="/js/random.js"></script>
  
    <script src="/js/highlight.pack.js"></script>
  
    <script src="/js/jquery.mousewheel.pack.js"></script>
  
    <script src="/js/jquery.fancybox.pack.js"></script>
  
    <script src="/js/jquery.fancybox-thumbs.js"></script>
  
    <script src="/js/plyr.js"></script>
  

<script>

  // fancybox
  var backgroundImages = [];
  
  $('#post').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox') || $(this).parent().hasClass('fancybox-thumb')) return;
      var alt = this.alt || this.title;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'post' + i);
    });
  });
  $(".fancybox").fancybox();

var vegasConfig = {"preload­Image":true,"transition":["slideLeft2","slideRight2","flash2"],"timer":true,"delay":5000,"shuffle":true,"count":28};
var unsplashConfig = {"gravity":"north"};
// is show background images
var turnoffBackgroundImage = false;



  turnoffBackgroundImage = true;


var backgroundColor = "f4f5f5";

$(".fancybox-thumb").fancybox({
  prevEffect: 'none',
  nextEffect: 'none',
  helpers: {
    title: {
      type: 'outside'
    },
    thumbs: {
      width: 50,
      height: 50
    }
  }
});

// show video with plyr
$(".video-container iframe").each(function(i){
  var url = $(this).attr('src');
  var id = url.split('/').pop();
  var plyrContainer = document.createElement('div');
  plyrContainer.className = 'plyr';
  var plyrElement = document.createElement('div');
  plyrElement.dataset.videoId = id;
  switch(true) {
    case url.search('youtube.com') >= 0:
      plyrElement.dataset.type = 'youtube';
      break;
    case url.search('vimeo.com') >= 0:
      plyrElement.dataset.type = 'vimeo';
      break;
    default:
      return;
  };
  plyrContainer.appendChild(plyrElement);
  $(this).parent().html(plyrContainer);
});
plyr.setup('.plyr', {iconUrl: '/css/sprite.svg'});
</script>
</body>
</html>

